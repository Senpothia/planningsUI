<!doctype html>
<html xmlns:th="http://www.thymeleaf.org">
<html lang="en">

<head>

	<meta charset="utf-8" />
	<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

	<!-- Bootstrap CSS -->
	<link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.4.1/css/bootstrap.min.css"
		integrity="sha384-Vkoo8x4CGsO3+Hhxv8T/Q5PaXtkKtu6ug5TOeNV6gBiFeWPGFN9MuhOf23Q9Ifjh" crossorigin="anonymous">

	<link rel="stylesheet" th:href="@{/css/styles.css}">
	<link rel="shortcut icon" type="image/x-icon" href="/images/logo0.png" />
	<title>Plannings</title>
	<meta charset="utf-8" />
	<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

	<!-- Bootstrap CSS -->
	<link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.4.1/css/bootstrap.min.css"
		integrity="sha384-Vkoo8x4CGsO3+Hhxv8T/Q5PaXtkKtu6ug5TOeNV6gBiFeWPGFN9MuhOf23Q9Ifjh" crossorigin="anonymous">

	<link rel="stylesheet" th:href="@{/css/styles.css}">
	<link rel="shortcut icon" type="image/x-icon" href="/images/logo0.png" />
	<title>Plannings</title>

	<script th:inline="javascript">

		var nom = /*[[${projet.nom}]]*/ null;
		var tableau = /*[[${tab}]]*/ null;
		var liste = /*[[${liste}]]*/ null;



		const lignes = [];

		for (i = 0; i < tableau.length; i++) {

			l = new Array(tableau[i].taskId, tableau[i].taskName, tableau[i].ressource,
				new Date(tableau[i].startDate), new Date(tableau[i].endDate), tableau[i].duration, tableau[i].percent, tableau[i].dependencies);
			lignes.push(l);
		}


		function HTMLtoPdf() {

			console.log("impression")

			var doc = new jsPDF();
			doc.text('Hello world', 10, 10)
			doc.save('testDoc.pdf')

		}

	</script>

	<script type="text/javascript" src="https://www.gstatic.com/charts/loader.js"></script>
	<script type="text/javascript">
		google.charts.load('current', {'packages': ['gantt']});
		google.charts.setOnLoadCallback(drawChart);
		var hauteur = lignes.length * 30 + 40;
		if (hauteur < 310) {
			hauteur = 310
		}
		function drawChart() {

			var data = new google.visualization.DataTable();
			data.addColumn('string', 'Task ID');
			data.addColumn('string', 'Task Name');
			data.addColumn('string', 'Resource');
			data.addColumn('date', 'Start Date');
			data.addColumn('date', 'End Date');
			data.addColumn('number', 'Duration');
			data.addColumn('number', 'Percent Complete');
			data.addColumn('string', 'Dependencies');

			data.addRows(lignes);

			var options = {
				height: hauteur,
				gantt: {
					trackHeight: 30
				}
			};

			var chart = new google.visualization.Gantt(document.getElementById('chart_div'));

			chart.draw(data, options);
		}
	</script>
</head>

<body>
	<script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
	<div class="container">
		<!-- ENTETE -->


		<div th:replace="fragments/entete_post :: entete_post"></div>

		<!-- ---------------- -->



		<section id="graphic">
			<div class="row">

				<h1>Diagramme de Gantt</h1>

			</div>

			<div class="col">

				<table class="table table-striped">
					<thead>


					</thead>
					<tbody>
						<tr>
							<th scope="row">Projet</th>
							<td th:text="${projet.nom}" />

						</tr>


						<tr>
							<th scope="row">Date</th>
							<td th:text="${#temporals.format(projet.date, 'dd-MM-yyyy')}" />

					</tr>


					<tr>
						<th scope="row">Créé par</th>
						<td th:text="${projet.nomChef}" />

					</tr>

					<tr>
						<th scope="row">Type</th>
						<td th:text="${projet.type}" />

					</tr>
				</tbody>
			</table>

		</div>
		</section>
	<div id="chart_div"></div>
	
	<span th:unless=${supprimer}>
		<div class="row mt-3">
			<div class="col d-flex justify-content-end">
				
				<span th:if=${liaisons}>
				<div class="form-group mr-3">
				
						<a th:href="@{/projet/liaisons/supprimer/{idProjet}(idProjet=${projet.id})}">
						<p type="text" class="btn btn-block" style="background-color: red; color: white">Supprimer liaisons</p>
					</a>
				</div>
				</span>
				
				<div class="form-group ">
					<a th:href="@{/projet/voir/{idProjet}(idProjet=${projet.id})}">
						<p type="text" class="btn btn-block" style="background-color: #7e60fb; color: white">Retour projet</p>
					</a>
				</div>

			</div>

		</div>
		</span>
					
		<span th:if=${groupe2}>
		
			<span th:if=${supprimer}>
				<div class="row mt-3">
					<div class="col d-flex justify-content-center">

						<form class="formulaire" th:action="@{/projet/liaisons/supprimer/{projet}(projet=${projet.id})}"
							th:object="${login}" method="post">
							<div>
								<h3 style="color: red;" th:if="${error}">Erreur! Vérifiez vous
									identifiants de connexion</h3>

							</div>

							<div>
								<h3 style="color: red;" th:unless="${error}">Entrez vos identifiants pour valider la
									suppression</h3>

							</div>

							<div class="form-group">
								<label for="email">Email</label> <input type="text" class="form-control" name="user">

							</div>
							<div class="form-group">
								<label for="password">Password</label> <input type="password" class="form-control"
									name="password">
							</div>

							<div class="float-right">

								<button type="submit" class="btn"
									style="background-color: red; color: white;">Supprimer</button>
							</div>

						</form>


					</div>


				</div>
				
				<span th:unless=${test}>

			<div class="row">

				<h1 style"color: red;">La supression des liaisons est rejetée!</h1>

			</div>


		</span>
		
		<span th:if=${test}>

			<div class="row">

				<h1 style"color: green;">Les liaisons ont été supprimées</h1>

			</div>


		</span>

			</span>
			
		</span>
	
	
		<!-- PIED DE PAGE -->

		<div th:replace="fragments/footer :: footer"></div>
	
</div>
	
</body>

</html>